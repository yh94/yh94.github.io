<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Yu Hang-Blog</title><meta name="keywords" content="博客"><meta name="author" content="Hang Yu"><meta name="copyright" content="Hang Yu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="欢迎来到我的王国">
<meta property="og:type" content="website">
<meta property="og:title" content="Yu Hang-Blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Yu Hang-Blog">
<meta property="og:description" content="欢迎来到我的王国">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/touxiang.jpeg">
<meta property="article:author" content="Hang Yu">
<meta property="article:tag" content="博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/touxiang.jpeg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Yu Hang-Blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-04-18 15:58:20'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./img/touxiang.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/./img/image1.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Yu Hang-Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Yu Hang-Blog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/yh94" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/18720982524@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2022/03/16/%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%AA%E6%8F%92%E4%BB%B6(%E4%BB%A3%E7%A0%81%E7%A5%9E%E5%99%A8)/" title="idea代码神器"><img class="post_bg" src="/./img/i5lBK9xbLj3UHwE3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="idea代码神器"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/03/16/%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%AA%E6%8F%92%E4%BB%B6(%E4%BB%A3%E7%A0%81%E7%A5%9E%E5%99%A8)/" title="idea代码神器">idea代码神器</a><div class="article-meta-wrap"><span class="article-meta"><i class="fas fa-thumbtack sticky"></i><span class="sticky">置顶</span><span class="article-meta-separator">|</span></span><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-03-16T07:30:10.000Z" title="发表于 2022-03-16 15:30:10">2022-03-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%8F%92%E4%BB%B6/">插件</a></span></div><div class="content">Copilot
我愿称之为最强插件。

首先是github copilot的官网地址 ：https://copilot.github.com/
进去之后自己看吧，贼拉牛逼，预判了我。
</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/04/18/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BD%91%E5%9D%80/" title="数据结构网址"><img class="post_bg" src="/./img/CBbAorRdXo4xRS0l.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构网址"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/04/18/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BD%91%E5%9D%80/" title="数据结构网址">数据结构网址</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-04-18T07:24:58.988Z" title="发表于 2022-04-18 15:24:58">2022-04-18</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">java</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/java/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></span></div><div class="content">这是一个可以观察各种数据结构的网址https://www.cs.usfca.edu/~galles/visualization/RedBlack.html
</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/04/16/QPS%E3%80%81TPS%E3%80%81%E5%B9%B6%E5%8F%91%E6%95%B0/" title="QPS、TPS、并发数"><img class="post_bg" src="/./img/nVtImLIfyslfo0Aq.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="QPS、TPS、并发数"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/04/16/QPS%E3%80%81TPS%E3%80%81%E5%B9%B6%E5%8F%91%E6%95%B0/" title="QPS、TPS、并发数">QPS、TPS、并发数</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-04-16T02:57:12.000Z" title="发表于 2022-04-16 10:57:12">2022-04-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">java</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/java/%E5%B9%B6%E5%8F%91/">并发</a></span></div><div class="content">1. 平均响应时长（每个用户请求）
公式：Time token for tests&#x2F;（Complete requests&#x2F;Concurrency Level）
用户平均请求等待时间 &#x3D; 总耗时 &#x2F;（总请求数 &#x2F; 并发数）
 结合1、2 &#x3D;&#x3D;&gt; 用户平均请求等待时间 &#x3D; 服务器平均请求等待时间 * 并发数



2. 服务器平均请求等待时间（每个请求）
公式：总耗时 &#x2F; 总请求数

3. QPS（每秒能够相应的查询次数）
公式：QPS &#x3D; 并发数 &#x2F; 平均响应时长
结合1、3 &#x3D;&#x3D;&gt; QPS &#x3D; 总请求数 &#x2F; 总耗时



4.TPS
每秒钟处理完的事务次数，一般TPS是对整个系统来讲的。一个应用系统1s能完成多少事务处理

5. 并发数（系统同时处理的request 或 事务数）
公式：并发数 &#x3D; QPS * 平均响应时长
指系统可以同时承载的正常使用系统功能的用户的数量



6. 吞吐量
F &#x3D; VU  ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/04/16/optional/" title="java8之optionAl用法"><img class="post_bg" src="/./img/tY3fs1oQKkhNarBr.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="java8之optionAl用法"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/04/16/optional/" title="java8之optionAl用法">java8之optionAl用法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-04-16T02:57:12.000Z" title="发表于 2022-04-16 10:57:12">2022-04-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">java</a></span></div><div class="content">实战使用
以前写法

12345678910111213public String getCity(User user)  throws Exception&#123;        if(user!=null)&#123;            if(user.getAddress()!=null)&#123;                Address address = user.getAddress();                if(address.getCity()!=null)&#123;                    return address.getCity();                &#125;            &#125;        &#125;        throw new Excpetion(&quot;取值错误&quot;);     &#125;```    &gt; JAVA8写法
public String getCity(User user) throws Exception{    return Optio ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/04/16/find%E5%91%BD%E4%BB%A4/" title="find命令"><img class="post_bg" src="https://picsum.photos/id/496/4288/2848" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="find命令"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/04/16/find%E5%91%BD%E4%BB%A4/" title="find命令">find命令</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-04-16T02:57:12.000Z" title="发表于 2022-04-16 10:57:12">2022-04-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">java</a></span></div><div class="content">1234567891011121314151617将当前目录及其子目录下所有文件后缀为 .c 的文件列出来:# find . -name &quot;*.c&quot;将当前目录及其子目录中的所有文件列出：# find . -type f将当前目录及其子目录下所有最近 20 天内更新过的文件列出:# find . -ctime -20查找 /var/log 目录中更改时间在 7 日以前的普通文件，并在删除之前询问它们：# find /var/log -type f -mtime +7 -ok rm &#123;&#125; \;查找当前目录中文件属主具有读、写权限，并且文件所属组的用户和其他用户具有读权限的文件：# find . -type f -perm 644 -exec ls -l &#123;&#125; \;查找系统中所有文件长度为 0 的普通文件，并列出它们的完整路径：# find / -type f -size 0 -exec ls -l &#123;&#125; \;</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/04/16/redis%E7%BA%BF%E4%B8%8A%E6%8E%92%E6%9F%A5/" title="redis问题排查"><img class="post_bg" src="/./img/9mxCGCLU9bxyeQtM.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="redis问题排查"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/04/16/redis%E7%BA%BF%E4%B8%8A%E6%8E%92%E6%9F%A5/" title="redis问题排查">redis问题排查</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-04-16T02:57:12.000Z" title="发表于 2022-04-16 10:57:12">2022-04-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">java</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/java/%E6%80%A7%E8%83%BD/">性能</a></span></div><div class="content">Redis问题排查
在系统缓慢的情况下，查出是内网带宽暂满的原因导致。通过网络工具查出Redis在高分期使用内网带宽达到300M&#x2F;S，占用总内网带宽的30%，于是对Redis问题进行排查。
通过RDB工具分析RDB中大Key的情况
RDB是redis数据库的快照文件，存储在硬盘上，用于持久化缓存。带宽过高，肯定是大Key的频繁读取导致的，所以要找出Redis中排在前几的大key进行分析，于是乎从网上找到了一款基于Go语言编写的一款RDB分析工具–RDR（https://github.com/xueqiu/rdr）。通过RDR加载RDB后，分析结果如下：

可以看到Redis的内存大小、key数量及大小、每个类型的数量、占比等，发现排在前几名的大Key分别是dataDicCache、configCache、sysPage、USER_PERMISSION。存储类型都是Hash，其中dataDicCache、configCache、sysPage在hash表中的数据都1条，但是大小却特别大，其中dataDicCache达到了惊人的918kb。通过Redis的MONITOR日志查看大 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/04/16/synchronized%E5%92%8Creentrantlock%E5%8C%BA%E5%88%AB/" title="synchronized和reentrantlock区别"><img class="post_bg" src="https://picsum.photos/id/1010/5184/3456" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="synchronized和reentrantlock区别"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/04/16/synchronized%E5%92%8Creentrantlock%E5%8C%BA%E5%88%AB/" title="synchronized和reentrantlock区别">synchronized和reentrantlock区别</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-04-16T02:57:12.000Z" title="发表于 2022-04-16 10:57:12">2022-04-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">java</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/java/%E9%94%81/">锁</a></span></div><div class="content">基本概念1、ReentrantLock 拥有Synchronized相同的并发性和内存语义，此外还多了 锁投票，定时锁等候和中断锁等候
 线程A和B都要获取对象O的锁定，假设A获取了对象O锁，B将等待A释放对O的锁定，

 如果使用 synchronized ，如果A不释放，B将一直等下去，不能被中断

 如果 使用ReentrantLock，如果A不释放，可以使B在等待了足够长的时间以后，中断等待，而干别的事情

ReentrantLock获取锁定与三种方式：  
a)  lock(), 如果获取了锁立即返回，如果别的线程持有锁，当前线程则一直处于休眠状态，直到获取锁

b) tryLock(), 如果获取了锁立即返回true，如果别的线程正持有锁，立即返回false；

c)**tryLock**(long timeout,[TimeUnit](http://houlinyan.iteye.com/java/util/concurrent/TimeUnit.html &quot;java.util.concurrent 中的枚举&quot;) unit)，   如果获取了锁定立即返 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/02/16/rabbitmq%E4%BF%9D%E8%AF%81%E6%B6%88%E6%81%AF/" title="如何保证消息的可靠性传输？（如何处理消息丢失的问题）"><img class="post_bg" src="/./img/i5lBK9xbLj3UHwE3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何保证消息的可靠性传输？（如何处理消息丢失的问题）"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/02/16/rabbitmq%E4%BF%9D%E8%AF%81%E6%B6%88%E6%81%AF/" title="如何保证消息的可靠性传输？（如何处理消息丢失的问题）">如何保证消息的可靠性传输？（如何处理消息丢失的问题）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-02-15T16:00:00.000Z" title="发表于 2022-02-16 00:00:00">2022-02-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">java</a></span></div><div class="content">这个是肯定的，用 MQ 有个基本原则，就是数据不能多一条，也不能少一条，不能多，就是重复消费和幂等性问题。不能少，就是说这数据别搞丢了。那这个问题你必须得考虑一下。
如果说你这个是用 MQ 来传递非常核心的消息，比如说计费、扣费的一些消息，那必须确保这个 MQ 传递过程中绝对不会把计费消息给弄丢。
RabbitMQ生产者弄丢了数据生产者将数据发送到 RabbitMQ 的时候，可能数据就在半路给搞丢了，因为网络问题啥的，都有可能。
此时可以选择用 RabbitMQ 提供的事务功能，就是生产者发送数据之前开启 RabbitMQ 事务 channel.txSelect ，然后发送消息，如果消息没有成功被 RabbitMQ 接收到，那么生产者会收到异常报错，此时就可以回滚事务 channel.txRollback ，然后重试发送消息；如果收到了消息，那么可以提交事务 channel.txCommit 。
123456789101112// 开启事务channel.txSelecttry &#123;    // 这里发送消息&#125; catch (Exception e) &#123;   ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2021/07/16/explain%E8%AF%A6%E8%A7%A3/" title="explain详解"><img class="post_bg" src="/./img/rpnT9CFe51XmTO0E.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="explain详解"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/07/16/explain%E8%AF%A6%E8%A7%A3/" title="explain详解">explain详解</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-07-15T16:00:00.000Z" title="发表于 2021-07-16 00:00:00">2021-07-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/mysql/">mysql</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/mysql/sql%E8%B0%83%E4%BC%98/">sql调优</a></span></div><div class="content">MySQL Explain详解[TOC]
12//查询叫张三的人explain select * from emo where name = &#x27;张三&#x27;

expain出来的信息有10列，分别是id、select_type、table、type、possible_keys、key、key_len、ref、rows、Extra概要描述：

id:  选择标识符

select_type: 表示查询的类型。

table: 输出结果集的表

partitions: 匹配的分区

type: 表示表的连接类型

possible_keys: 表示查询时，可能使用的索引

key: 表示实际使用的索引

key_len: 索引字段的长度

ref: 列与索引的比较

rows: 扫描出的行数(估算的行数)

filtered: 按表条件过滤的行百分比

Extra: 执行情况的描述和说明
1、id
SELECT识别符。这是SELECT的查询序列号我的理解是SQL执行的顺序的标识，SQL从大到小的执行。

2、select_type
 示查询中每个select子句的类型


S ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2021/03/10/Redis%E5%85%AD%E7%A7%8D%E5%BA%95%E5%B1%82%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="redis底层数据结构"><img class="post_bg" src="https://picsum.photos/id/496/4288/2848" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="redis底层数据结构"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/03/10/Redis%E5%85%AD%E7%A7%8D%E5%BA%95%E5%B1%82%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="redis底层数据结构">redis底层数据结构</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-03-09T16:00:00.000Z" title="发表于 2021-03-10 00:00:00">2021-03-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/java/">java</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/java/redis/">redis</a></span></div><div class="content">文章目录
一、简单动态字符串

1、SDS的结构定义


2、SDS和c字符串的区别

1）SDS获取字符串长度复杂度为常数


2）SDS杜绝了缓冲区溢出
3）减少内存重分配次数
4）二进制安全
5）SDS兼容部分c字符串函数
二、双向链表

1、双向链表结构：


2、链表节点结构：
3、Redis的链表实现的特性：
三、字典

1、字典的实现结构



1）哈希表节点


2）哈希表
3）字典
2、哈希算法

MurmurHash2算法


3、哈希表的重新散列（rehash）
四、跳跃表

1、跳跃表节点的结构（zskiplistNode）


2、跳跃表的结构（zskiplist）
五、整数集合

1、整数集合的结构


2、整数集合的升级
六、压缩列表

1、压缩列表的构成


2、压缩列表节点的结构
3、连锁更新

本文将详细介绍Redis的六种底层数据结构：简单动态字符串、双向链表、字典、跳跃表、整数集合和压缩列表。
一、简单动态字符串Redis没有直接使用c语言传统的字符串表示，而是自己构建了一种名为简单动态字符串的可以被修改的抽象类型，并将SDS用作Redis的默认 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./img/touxiang.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Hang Yu</div><div class="author-info__description">欢迎来到我的王国</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yh94"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/yh94" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/18720982524@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">人无再少年</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/04/18/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BD%91%E5%9D%80/" title="数据结构网址"><img src="/./img/CBbAorRdXo4xRS0l.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构网址"/></a><div class="content"><a class="title" href="/2022/04/18/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%BD%91%E5%9D%80/" title="数据结构网址">数据结构网址</a><time datetime="2022-04-18T07:24:58.988Z" title="发表于 2022-04-18 15:24:58">2022-04-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/16/QPS%E3%80%81TPS%E3%80%81%E5%B9%B6%E5%8F%91%E6%95%B0/" title="QPS、TPS、并发数"><img src="/./img/nVtImLIfyslfo0Aq.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="QPS、TPS、并发数"/></a><div class="content"><a class="title" href="/2022/04/16/QPS%E3%80%81TPS%E3%80%81%E5%B9%B6%E5%8F%91%E6%95%B0/" title="QPS、TPS、并发数">QPS、TPS、并发数</a><time datetime="2022-04-16T02:57:12.000Z" title="发表于 2022-04-16 10:57:12">2022-04-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/16/optional/" title="java8之optionAl用法"><img src="/./img/tY3fs1oQKkhNarBr.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="java8之optionAl用法"/></a><div class="content"><a class="title" href="/2022/04/16/optional/" title="java8之optionAl用法">java8之optionAl用法</a><time datetime="2022-04-16T02:57:12.000Z" title="发表于 2022-04-16 10:57:12">2022-04-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/16/find%E5%91%BD%E4%BB%A4/" title="find命令"><img src="https://picsum.photos/id/496/4288/2848" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="find命令"/></a><div class="content"><a class="title" href="/2022/04/16/find%E5%91%BD%E4%BB%A4/" title="find命令">find命令</a><time datetime="2022-04-16T02:57:12.000Z" title="发表于 2022-04-16 10:57:12">2022-04-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/16/redis%E7%BA%BF%E4%B8%8A%E6%8E%92%E6%9F%A5/" title="redis问题排查"><img src="/./img/9mxCGCLU9bxyeQtM.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="redis问题排查"/></a><div class="content"><a class="title" href="/2022/04/16/redis%E7%BA%BF%E4%B8%8A%E6%8E%92%E6%9F%A5/" title="redis问题排查">redis问题排查</a><time datetime="2022-04-16T02:57:12.000Z" title="发表于 2022-04-16 10:57:12">2022-04-16</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/java/"><span class="card-category-list-name">java</span><span class="card-category-list-count">8</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/java/redis/"><span class="card-category-list-name">redis</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/java/%E5%B9%B6%E5%8F%91/"><span class="card-category-list-name">并发</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/java/%E6%80%A7%E8%83%BD/"><span class="card-category-list-name">性能</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/java/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"><span class="card-category-list-name">数据结构</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/java/%E9%94%81/"><span class="card-category-list-name">锁</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/mysql/"><span class="card-category-list-name">mysql</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/mysql/sql%E8%B0%83%E4%BC%98/"><span class="card-category-list-name">sql调优</span><span class="card-category-list-count">1</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/java/" style="font-size: 1.45em; color: rgb(53, 128, 146)">java</a><a href="/tags/sql%E8%B0%83%E4%BC%98/" style="font-size: 1.15em; color: rgb(44, 106, 164)">sql调优</a><a href="/tags/redis/" style="font-size: 1.3em; color: rgb(69, 46, 105)">redis</a><a href="/tags/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/" style="font-size: 1.15em; color: rgb(148, 20, 86)">消息中间件</a><a href="/tags/idea/" style="font-size: 1.15em; color: rgb(199, 142, 25)">idea</a><a href="/tags/%E6%8F%92%E4%BB%B6/" style="font-size: 1.15em; color: rgb(1, 164, 62)">插件</a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 1.15em; color: rgb(121, 89, 183)">数据结构</a><a href="/tags/%E7%B3%BB%E7%BB%9F/" style="font-size: 1.15em; color: rgb(193, 192, 180)">系统</a><a href="/tags/%E6%9E%B6%E6%9E%84/" style="font-size: 1.15em; color: rgb(150, 35, 176)">架构</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/04/"><span class="card-archive-list-date">四月 2022</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/03/"><span class="card-archive-list-date">三月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/02/"><span class="card-archive-list-date">二月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span class="card-archive-list-date">七月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/03/"><span class="card-archive-list-date">三月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/05/"><span class="card-archive-list-date">五月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/09/"><span class="card-archive-list-date">九月 2019</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">12</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2019-07-04T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-04-18T07:58:20.230Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2022 By Hang Yu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Can I make a friend with you ？</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["我们知道自己是谁，但不知道自己能成为谁"],
      startDelay: 300,
      typeSpeed: 150,
      loop: false,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = '我们知道自己是谁，但不知道自己能成为谁'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>